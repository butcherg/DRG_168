

OPENSCAD="/c/Program Files/OpenSCAD/openscad.exe" --enable=manifold --enable=lazy-union

SRC  := ../scad
OBJ  := .
BIN  := .
SRCS := $(wildcard $(SRC)/*.scad)
OBJS := $(patsubst $(SRC)/%.scad,%.stl,$(SRCS))
EXE  := foo.txt
BASENAMES    := $(patsubst $(SRC)/%.scad,%,$(SCADS))

.PHONY: all clean

all: $(OBJS)

$(OBJ)/%.stl: $(SRC)/%.scad | $(OBJ)
	$(OPENSCAD) --export-format binstl -o $@ $<

clean:
	rm -f *.stl

dist:
	mkdir DRG_168
	cp ../lib/globals.scad DRG_168/.
	cp *.stl DRG_168/.
	cp stl_integration.scad DRG_168/.
	sed -i 's/\.\.\/lib\///g' DRG_168/stl_integration.scad
	sed 's/\/\///' DRG_168/stl_integration.scad > DRG_168/foo.scad
	$(OPENSCAD) --export-format 3mf -o DRG_168/stl_integration.3mf DRG_168/foo.scad
	rm DRG_168/foo.scad
	tar -czvf DRG_168_STLs.tar.gz DRG_168
	rm -rf DRG_168

#Makefile generated by scadmake

all: firebox_backhead.stl cab.stl crosshead.stl compressor.stl 168_plate.stl pilot_truck.stl cistern.stl smokebox_front.stl wheel_set.stl siderod.stl tender_truck.stl brake_assembly_port.stl generator.stl whistle.stl handrail_endball.stl driver_set.stl tender_ladder.stl smokebox_boiler_firebox_assembly.stl tender_frame.stl crossheadguide_hangar.stl footboards.stl headlamp.stl brake_assembly_starboard.stl bell_hangar_assembly.stl frame.stl frontend_assembly.stl connecting_rod.stl

firebox_backhead.stl:  ../scad/firebox_backhead.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad ../lib/globals.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o firebox_backhead.stl ../scad/firebox_backhead.scad

cab.stl:  ../scad/cab.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad ../lib/cab_floor.scad ../lib/cab_rear_support.scad ../lib/globals.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o cab.stl ../scad/cab.scad

crosshead.stl:  ../scad/crosshead.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o crosshead.stl ../scad/crosshead.scad

compressor.stl:  ../scad/compressor.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o compressor.stl ../scad/compressor.scad

168_plate.stl:  ../scad/168_plate.scad ../lib/Round-Anything/polyround.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o 168_plate.stl ../scad/168_plate.scad

pilot_truck.stl:  ../scad/pilot_truck.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o pilot_truck.stl ../scad/pilot_truck.scad

cistern.stl:  ../scad/cistern.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o cistern.stl ../scad/cistern.scad

smokebox_front.stl:  ../scad/smokebox_front.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o smokebox_front.stl ../scad/smokebox_front.scad

wheel_set.stl:  ../scad/wheel_set.scad ../lib/RP25_wheels.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o wheel_set.stl ../scad/wheel_set.scad

siderod.stl:  ../scad/siderod.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o siderod.stl ../scad/siderod.scad

tender_truck.stl:  ../scad/tender_truck.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o tender_truck.stl ../scad/tender_truck.scad

brake_assembly_port.stl:  ../scad/brake_assembly_port.scad ../lib/brake_assembly.scad ../lib/Round-Anything/polyround.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o brake_assembly_port.stl ../scad/brake_assembly_port.scad

generator.stl:  ../scad/generator.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o generator.stl ../scad/generator.scad

whistle.stl:  ../scad/whistle.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o whistle.stl ../scad/whistle.scad

handrail_endball.stl:  ../scad/handrail_endball.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o handrail_endball.stl ../scad/handrail_endball.scad

driver_set.stl:  ../scad/driver_set.scad ../lib/RP25_wheels.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o driver_set.stl ../scad/driver_set.scad

tender_ladder.stl:  ../scad/tender_ladder.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o tender_ladder.stl ../scad/tender_ladder.scad

smokebox_boiler_firebox_assembly.stl:  ../scad/smokebox_boiler_firebox_assembly.scad ../lib/smokebox.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad ../lib/168_plaque.scad ../lib/boiler.scad ../lib/firebox.scad ../lib/smokestack.scad ../lib/sanddome.scad ../lib/steamdome.scad ../lib/globals.scad ../scad/footboards.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o smokebox_boiler_firebox_assembly.stl ../scad/smokebox_boiler_firebox_assembly.scad

tender_frame.stl:  ../scad/tender_frame.scad ../lib/Round-Anything/polyround.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o tender_frame.stl ../scad/tender_frame.scad

crossheadguide_hangar.stl:  ../scad/crossheadguide_hangar.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad ../lib/globals.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o crossheadguide_hangar.stl ../scad/crossheadguide_hangar.scad

footboards.stl:  ../scad/footboards.scad ../lib/Round-Anything/polyround.scad ../lib/utilities.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o footboards.stl ../scad/footboards.scad

headlamp.stl:  ../scad/headlamp.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o headlamp.stl ../scad/headlamp.scad

brake_assembly_starboard.stl:  ../scad/brake_assembly_starboard.scad ../lib/brake_assembly.scad ../lib/Round-Anything/polyround.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o brake_assembly_starboard.stl ../scad/brake_assembly_starboard.scad

bell_hangar_assembly.stl:  ../scad/bell_hangar_assembly.scad ../lib/bell.scad ../lib/Round-Anything/polyround.scad ../lib/bellhangar.scad ../lib/path_extrude.scad ../lib/utilities.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o bell_hangar_assembly.stl ../scad/bell_hangar_assembly.scad

frame.stl:  ../scad/frame.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad ../lib/globals.scad ../lib/brake_assembly.scad ../scad/driver_set.scad ../lib/RP25_wheels.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o frame.stl ../scad/frame.scad

frontend_assembly.stl:  ../scad/frontend_assembly.scad ../lib/frontend.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad ../lib/168_pilot.scad ../scad/crossheadguide_hangar.scad ../lib/globals.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o frontend_assembly.stl ../scad/frontend_assembly.scad

connecting_rod.stl:  ../scad/connecting_rod.scad ../lib/utilities.scad ../lib/Round-Anything/polyround.scad ../lib/path_extrude.scad
	openscad --enable-manifold --enable=lazy-union --export-format binstl -o connecting_rod.stl ../scad/connecting_rod.scad


